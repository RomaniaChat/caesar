(()=>{"use strict";var t={564:t=>{t.exports=JSON.parse('[{"name":"adventurer","options":{}},{"name":"adventurer-neutral","options":{}},{"name":"avataaars","options":{"translateY":5}},{"name":"avataaars-neutral","options":{}},{"name":"big-ears","options":{}},{"name":"big-ears-neutral","options":{}},{"name":"big-smile","options":{}},{"name":"bottts","options":{"scale":80}},{"name":"bottts-neutral","options":{}},{"name":"croodles","options":{}},{"name":"croodles-neutral","options":{}},{"name":"dylan","options":{}},{"name":"fun-emoji","options":{}},{"name":"glass","options":{}},{"name":"icons","options":{}},{"name":"identicon","options":{}},{"name":"initials","options":{}},{"name":"lorelei","options":{}},{"name":"lorelei-neutral","options":{}},{"name":"micah","options":{"translateY":5}},{"name":"miniavs","options":{}},{"name":"notionists","options":{"translateY":5}},{"name":"notionists-neutral","options":{}},{"name":"open-peeps","options":{"flip":true}},{"name":"personas","options":{"translateY":5}},{"name":"pixel-art","options":{"translateY":5}},{"name":"pixel-art-neutral","options":{}},{"name":"rings","options":{}},{"name":"shapes","options":{}},{"name":"thumbs","options":{}}]')}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={exports:{}};return t[a](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};function i(t){return t.replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}n.r(a),n.d(a,{create:()=>v,meta:()=>g,schema:()=>f});const o=-2147483648;function r(t){return t^=t<<13,t^=t>>17,t^=t<<5}function s(t=""){let e=function(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n)|0,e=r(e);return e}(t=t.toString())||1;const n=()=>e=r(e),a=(t,e)=>Math.floor((n()-o)/4294967295*(e+1-t)+t);return{seed:t,next:n,bool:(t=50)=>a(1,100)<=t,integer:(t,e)=>a(t,e),pick(t,e){var i;return 0===t.length?(n(),e):null!==(i=t[a(0,t.length-1)])&&void 0!==i?i:e},shuffle(t){const e=s(n().toString()),a=[...t];for(let n=a.length-1;n>0;n--){const t=e.integer(0,n);[a[n],a[t]]=[a[t],a[n]]}return a},string(t,e="abcdefghijklmnopqrstuvwxyz1234567890"){const a=s(n().toString());let i="";for(let n=0;n<t;n++)i+=e[a.integer(0,e.length-1)];return i}}}function l(t){let e=t.attributes.viewBox.split(" ");return{x:parseInt(e[0]),y:parseInt(e[1]),width:parseInt(e[2]),height:parseInt(e[3])}}const u={type:"object",$schema:"http://json-schema.org/draft-07/schema#",properties:{seed:{type:"string"},flip:{type:"boolean",default:!1},rotate:{type:"integer",minimum:0,maximum:360,default:0},scale:{type:"integer",minimum:0,maximum:200,default:100},radius:{type:"integer",minimum:0,maximum:50,default:0},size:{type:"integer",minimum:1},backgroundColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"}},backgroundType:{type:"array",items:{type:"string",enum:["solid","gradientLinear"]},default:["solid"]},backgroundRotation:{type:"array",items:{type:"integer",minimum:-360,maximum:360},default:[0,360]},translateX:{type:"integer",minimum:-100,maximum:100,default:0},translateY:{type:"integer",minimum:-100,maximum:100,default:0},clip:{type:"boolean",default:!0},randomizeIds:{type:"boolean",default:!1}}};function c(t){var e;let n={},a=null!==(e=t.properties)&&void 0!==e?e:{};return Object.keys(a).forEach((t=>{let e=a[t];"object"==typeof e&&void 0!==e.default&&(Array.isArray(e.default)?n[t]=[...e.default]:"object"==typeof e.default?n[t]={...e.default}:n[t]=e.default)})),n}function d(t){return"transparent"===t?t:`#${t}`}function m(t,e={}){var n,a,o,r,m;e=function(t,e){var n;let a={...c(u),...c(null!==(n=t.schema)&&void 0!==n?n:{}),...e};return JSON.parse(JSON.stringify(a))}(t,e);const p=s(e.seed),f=t.create({prng:p,options:e}),g=p.pick(null!==(n=e.backgroundType)&&void 0!==n?n:[],"solid"),{primary:v,secondary:y}=function(t,e,n){var a;let i=t.shuffle(e);i.length<=1||2==e.length&&"gradientLinear"==n?(i=e,t.next()):i=t.shuffle(e),0===i.length&&(i=["transparent"]);const o=i[0],r=null!==(a=i[1])&&void 0!==a?a:i[0];return{primary:d(o),secondary:d(r)}}(p,null!==(a=e.backgroundColor)&&void 0!==a?a:[],g),h=p.integer((null===(o=e.backgroundRotation)||void 0===o?void 0:o.length)?Math.min(...e.backgroundRotation):0,(null===(r=e.backgroundRotation)||void 0===r?void 0:r.length)?Math.max(...e.backgroundRotation):0);e.size&&(f.attributes.width=e.size.toString(),f.attributes.height=e.size.toString()),void 0!==e.scale&&100!==e.scale&&(f.body=function(t,e){let{width:n,height:a,x:i,y:o}=l(t),r=e?(e-100)/100:0;return`<g transform="translate(${(n/2+i)*r*-1} ${(a/2+o)*r*-1}) scale(${e/100})">${t.body}</g>`}(f,e.scale)),e.flip&&(f.body=function(t){let{width:e,x:n}=l(t);return`<g transform="scale(-1 1) translate(${-1*e-2*n} 0)">${t.body}</g>`}(f)),e.rotate&&(f.body=function(t,e){let{width:n,height:a,x:i,y:o}=l(t);return`<g transform="rotate(${e}, ${n/2+i}, ${a/2+o})">${t.body}</g>`}(f,e.rotate)),(e.translateX||e.translateY)&&(f.body=function(t,e,n){let a=l(t);return`<g transform="translate(${(a.width+2*a.x)*((null!=e?e:0)/100)} ${(a.height+2*a.y)*((null!=n?n:0)/100)})">${t.body}</g>`}(f,e.translateX,e.translateY)),"transparent"!==v&&"transparent"!==y&&(f.body=function(t,e,n,a,i){let{width:o,height:r,x:s,y:u}=l(t);const c=`<rect fill="${e}" width="${o}" height="${r}" x="${s}" y="${u}" />`;switch(a){case"solid":return c+t.body;case"gradientLinear":return`<rect fill="url(#backgroundLinear)" width="${o}" height="${r}" x="${s}" y="${u}" /><defs><linearGradient id="backgroundLinear" gradientTransform="rotate(${i} 0.5 0.5)"><stop stop-color="${e}"/><stop offset="1" stop-color="${n}"/></linearGradient></defs>`+t.body}}(f,v,y,g,h)),(e.radius||e.clip)&&(f.body=function(t,e){let{width:n,height:a,x:i,y:o}=l(t);return`<mask id="viewboxMask"><rect width="${n}" height="${a}" rx="${e?n*e/100:0}" ry="${e?a*e/100:0}" x="${i}" y="${o}" fill="#fff" /></mask><g mask="url(#viewboxMask)">${t.body}</g>`}(f,null!==(m=e.radius)&&void 0!==m?m:0)),e.randomizeIds&&(f.body=function(t){const e=s(Math.random().toString()),n={};return t.body.replace(/(id="|url\(#)([a-z0-9-_]+)([")])/gi,((t,a,i,o)=>(n[i]=n[i]||e.string(8),`${a}${n[i]}${o}`)))}(f));const b=function(t){const e={xmlns:"http://www.w3.org/2000/svg",...t.attributes};return Object.keys(e).map((t=>`${i(t)}="${i(e[t])}"`)).join(" ")}(f),$=function(t){var e,n,a,o,r,s,l;const u=null===(e=t.meta)||void 0===e?void 0:e.title,c=null===(n=t.meta)||void 0===n?void 0:n.creator,d=null===(a=t.meta)||void 0===a?void 0:a.source,m=null===(r=null===(o=t.meta)||void 0===o?void 0:o.license)||void 0===r?void 0:r.url,p=function(t){var e,n,a,i,o,r,s,l,u,c,d,m,p,f,g;let v=(null===(e=t.meta)||void 0===e?void 0:e.title)?`„${null===(n=t.meta)||void 0===n?void 0:n.title}”`:"Design",y=`„${null!==(i=null===(a=t.meta)||void 0===a?void 0:a.creator)&&void 0!==i?i:"Unknown"}”`;(null===(o=t.meta)||void 0===o?void 0:o.source)&&(v+=` (${t.meta.source})`);let h="";return"MIT"!==(null===(s=null===(r=t.meta)||void 0===r?void 0:r.license)||void 0===s?void 0:s.name)&&"DiceBear"!==(null===(l=t.meta)||void 0===l?void 0:l.creator)&&(null===(u=t.meta)||void 0===u?void 0:u.title)&&(h+="Remix of "),h+=`${v} by ${y}`,(null===(d=null===(c=t.meta)||void 0===c?void 0:c.license)||void 0===d?void 0:d.name)&&(h+=`, licensed under „${null===(p=null===(m=t.meta)||void 0===m?void 0:m.license)||void 0===p?void 0:p.name}”`,(null===(g=null===(f=t.meta)||void 0===f?void 0:f.license)||void 0===g?void 0:g.url)&&(h+=` (${t.meta.license.url})`)),h}(t);return u||c||d||m||p?'<metadata xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/"><rdf:RDF><rdf:Description>'+(u?`<dc:title>${i(u)}</dc:title>`:"")+(c?`<dc:creator>${i(c)}</dc:creator>`:"")+(d?`<dc:source xsi:type="dcterms:URI">${i(null!==(l=null===(s=t.meta)||void 0===s?void 0:s.source)&&void 0!==l?l:"")}</dc:source>`:"")+(m?`<dcterms:license xsi:type="dcterms:URI">${i(m)}</dcterms:license>`:"")+(p?`<dc:rights>${i(p)}</dc:rights>`:"")+"</rdf:Description></rdf:RDF></metadata>":""}(t),x=`<svg ${b}>${$}${f.body}</svg>`;return{toString:()=>x,toJson:()=>{var t;return{svg:x,extra:{primaryBackgroundColor:v,secondaryBackgroundColor:y,backgroundType:g,backgroundRotation:h,...null===(t=f.extra)||void 0===t?void 0:t.call(f)}}},toDataUri:()=>`data:image/svg+xml;utf8,${encodeURIComponent(x)}`}}function p(t,e=!0){const n=(e?t.replace(/@.*/,""):t).match(/(\p{L}[\p{L}\p{M}]*)/gu);if(!n)return e?p(t,!1):"";if(1===n.length)return n[0].match(/^(?:\p{L}\p{M}*){1,2}/u)[0].toUpperCase();return(n[0].match(/^(?:\p{L}\p{M}*)/u)[0]+n[n.length-1].match(/^(?:\p{L}\p{M}*)/u)[0]).toUpperCase()}const f={$schema:"http://json-schema.org/draft-07/schema#",properties:{backgroundColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["e53935","d81b60","8e24aa","5e35b1","3949ab","1e88e5","039be5","00acc1","00897b","43a047","7cb342","c0ca33","fdd835","ffb300","fb8c00","f4511e"]},textColor:{type:"array",items:{type:"string",pattern:"^(transparent|[a-fA-F0-9]{6})$"},default:["ffffff"]},fontFamily:{type:"array",minItems:1,items:{type:"string",enum:["Arial","Verdana","Helvetica","Tahoma","Trebuchet MS","Times New Roman","Georgia","Garamond","Courier New","Brush Script MT","sans-serif","serif"]},default:["Arial","sans-serif"]},fontSize:{type:"integer",minimum:1,maximum:100,default:50},chars:{type:"integer",minimum:0,maximum:2,default:2},fontWeight:{type:"integer",default:400,enum:[100,200,300,400,500,600,700,800,900]}}},g={title:"Initials",creator:"DiceBear",source:"https://github.com/dicebear/dicebear",license:{name:"CC0 1.0",url:"https://creativecommons.org/publicdomain/zero/1.0/"}},v=({prng:t,options:e})=>{var n,a,i,o,r,s,l;const u=null!==(a=null===(n=e.fontFamily)||void 0===n?void 0:n.join(", "))&&void 0!==a?a:"Arial, sans-serif",c=null!==(i=e.fontSize)&&void 0!==i?i:50,d=null!==(o=e.fontWeight)&&void 0!==o?o:400,m="transparent"===(f=null!==(s=t.pick(null!==(r=e.textColor)&&void 0!==r?r:[]))&&void 0!==s?s:"ffffff")?f:`#${f}`;var f;const g=p(t.seed.trim()).slice(0,null!==(l=e.chars)&&void 0!==l?l:2);var v;return{attributes:{viewBox:"0 0 100 100"},body:[`<text x="50%" y="50%" font-family="${u}" font-size="${c}" font-weight="${d}" fill="${m}" text-anchor="middle" dy="${(.356*c).toFixed(3)}">${v=g,v.replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</text>`].join(""),extra:()=>({fontFamily:u,fontSize:c,fontWeight:d,textColor:m,initials:g})}};var y,h,b=n(564),$=(y=document.getElementsByTagName("script"),(h=y[y.length-1].src).substr(0,h.lastIndexOf("/")+1)),x="plugin-avatars",w={path:$+"plugin-avatars/%style%.js",style:"initials",styles:b,stylesOptions:{},autoLoad:!0};function k(){var t,e,n=j("avatar_style");n&&(console.warn("[Deprecated] config option 'plugin-avatars.avatar_style' changed to 'plugin-avatars.style'. Please update your config.json"),t="style",e=n,kiwi.state.setSetting(["settings",x,t].join("."),e)),kiwi.setConfigDefaults(x,w)}function S(t,e){return kiwi.state.setting([x,t].join("."),e)}function j(t){return kiwi.state.getSetting(["settings",x,t].join("."))}var T={initials:{module:a,options:{}}};kiwi.plugin("avatars",(function(){k();var t=kiwi.require("libs/Logger").namespace("plugin-avatars"),e="data:image/svg+xml;plugin-avatars;",n=kiwi.pluginAvatars={loadingAvatars:0,updateTimeouts:Object.create(null),styles:T,addStyle:function(t,e){var a=j("styles").find((function(e){return e.name===t})),i=a?a.options:{},o=j("stylesOptions."+t);o&&Object.assign(i,o),n.styles[t]={module:e,options:i}},hasStyle:function(t){return!!n.styles[t]},canStyle:function(t){return!!n.hasStyle(t)||j("styles").some((function(e){return e.name===t}))}},a=S("style");function i(e,a){var i=document.createElement("script");i.type="text/javascript",i.src=j("path").replace("%style%",e),i.onerror=function(o){n.loadingAvatars--,document.body.removeChild(i),S("style",a),t.error("Failed to load avatar.",o.message,'[style="'.concat(e,'"]'))},i.onload=function(){n.loadingAvatars--,n.loadingAvatars||s()},n.loadingAvatars++,document.body.appendChild(i)}function o(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.avatar;if((a||!i.small&&!i.large)&&r(i,a)){var o=S("style").toLowerCase(),s=Object.hasOwnProperty.call(n.styles,o)?o:Object.keys(n.styles)[0],l={seed:(t.account||t.nick).toLowerCase(),scale:90,backgroundColor:[]},u=n.styles[s];u.options&&Object.assign(l,u.options);var c=m(u.module,l).toDataUri();r(t.avatar,a)&&Object.assign(t.avatar,{small:c.replace(/^data:image\/svg\+xml;/,e),large:""})}}function r(t,n){return!t.large&&(!t.small||t.small.startsWith(e)&&n)}function s(){Object.keys(n.updateTimeouts).forEach((function(t){clearTimeout(n.updateTimeouts[t]),delete n.updateTimeouts[t]})),kiwi.state.networks.forEach((function(t){var e=t.currentUser(),a=Object.values(t.users).filter((function(t){return t!==e&&t.avatarCache&&r(t.avatar,!0)}));e&&a.unshift(e),n.updateTimeouts[t.id]=setTimeout((function(){return l(t,a)}),0)}))}function l(t,e){e.splice(0,50).forEach((function(t){return o(t,!0)})),e.length?n.updateTimeouts[t.id]=setTimeout((function(){return l(t,e)}),0):delete n.updateTimeouts[t.id]}n.hasStyle(a)||(j("autoLoad")&&n.canStyle(a)?i(a,w.style):S("style",w.style)),kiwi.state.$watch((function(){return S("style")}),(function(t,e){!j("autoLoad")&&!n.hasStyle(t)||!n.canStyle(t)?S("style",e):n.hasStyle(t)?s():i(t,e)})),kiwi.on("irc.wholist",(function(t,e){kiwi.Vue.nextTick((function(){t.users.forEach((function(t){var n=kiwi.state.getUser(e.id,t.nick);n&&n.avatarCache&&o(n)}))}))})),kiwi.on("irc.nick",(function(t,e){kiwi.Vue.nextTick((function(){var n=kiwi.state.getUser(e.id,t.nick);n&&o(n,!0)}))})),kiwi.on("irc.account",(function(t,e){kiwi.Vue.nextTick((function(){var n=kiwi.state.getUser(e.id,t.nick);n&&o(n,!0)}))})),kiwi.on("user.avatar.create",(function(t){o(t.user)})),kiwi.on("user.avatar.failed",(function(t){t.failed.startsWith(e)||o(t.user)}))}))})();